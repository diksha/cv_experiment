load("@pip_deps//:requirements.bzl", "requirement")
load("@rules_python//python:defs.bzl", "py_library")

package(default_visibility = ["//visibility:public"])

py_library(
    name = "state_classifier_vision",
    srcs = [
        "state_classifier_vision.py",
    ],
    data = [
        "//core/ml/training/configs",
        "@artifacts_01_09_2023_wn_foods_hayward_0009_cha",
        "@artifacts_01_09_2023_wn_foods_hayward_0012_cha",
        "@artifacts_01_18_2023_generalized-front-door",  # Used for innovate_manufacturing/knoxville/0005/cha!
        "@artifacts_02_06_2023_generalized_EXIT_Door_new",  # wesco/reno currently uses this!
        "@artifacts_02_09_2023_old_generalized_side_door",  # Used for innovate_manufacturing/knoxville/0004/cha & jfe_shoji/14!
        "@artifacts_02_15_2023_americold_ontario_0005_cha",
        "@artifacts_02_15_2023_americold_ontario_0006_cha",
        "@artifacts_02_15_2023_americold_tacoma_0005_cha",
        "@artifacts_02_15_2023_buildersfirstsource_dixieline_0001_cha",
        "@artifacts_02_15_2023_innovate_manufacturing_knoxville_0004_cha",
        "@artifacts_02_15_2023_wn_foods_hayward_0011_cha",
        "@artifacts_02_24_2023_americold_ontario_0004_cha",  # Trained on the dataflywheel and new data ingestion
        "@artifacts_03_04_2023_generalized_freezer_door",
        "@artifacts_03_05_2023_americold_modesto_0011_cha",
        "@artifacts_03_13_2023_americold_ontario_0104_fine_tuned_freezer_generalized_model",
        "@artifacts_04_03_2023_ulta_dallas_0003_cha_local",
        "@artifacts_04_05_2023_jfe_shoji_burlington_0011_cha",
        "@artifacts_05_02_2023_americold_ontario_0104_cha",
        "@artifacts_05_02_2023_jfe_shoji_burlington_0010_cha",
        "@artifacts_05_10_2023_uscold_syracuse_0001_cha",
        "@artifacts_05_10_2023_vertical_cold_storage_bolingbrook_0003_cha",
        "@artifacts_05_10_2023_vertical_cold_storage_bolingbrook_0004_cha",
        "@artifacts_05_10_2023_vertical_cold_storage_bolingbrook_0005_cha",
        "@artifacts_05_11_2023_vertical_cold_storage_bolingbrook_0002_cha",
        "@artifacts_05_14_2023_uscold_syracuse_0006_cha",
        "@artifacts_05_14_2023_uscold_syracuse_0008_cha",
        "@artifacts_05_14_2023_uscold_syracuse_0009_cha",
        "@artifacts_05_15_2023_vertical_cold_storage_bolingbrook_0001_cha",
        "@artifacts_05_18_2023_uscold_syracuse_0007_cha",
        "@artifacts_05_18_2023_vertical_cold_storage_richardson_0001_cha",
        "@artifacts_05_18_2023_vertical_cold_storage_richardson_0004_cha",
        "@artifacts_05_18_2023_vertical_cold_storage_richardson_0008_cha",
        "@artifacts_05_19_2023_vertical_cold_storage_richardson_0003_cha",
        "@artifacts_05_23_2023_verst_hebron_0004_cha",
        "@artifacts_05_27_2023_vertical_cold_storage_richardson_0002_cha",
        "@artifacts_05_27_2023_vertical_cold_storage_richardson_0006_cha",
        "@artifacts_05_27_2023_wn_foods_hayward_0011_cha",
        "@artifacts_05_28_2023_uscold_syracuse_0010_cha",
        "@artifacts_05_30_2023_ulta_dallas_0001_cha",
        "@artifacts_05_30_2023_ulta_dallas_0004_cha",
        "@artifacts_05_30_2023_verst_hebron_0001_cha",
        "@artifacts_06_01_2023_vertical_cold_storage_richardson_0009_cha",
        "@artifacts_2022-08-26-T18-42buildersfirstsource_solanabeach_0009_cha",
        "@artifacts_2022-10-21-T16-34americold_taunton_0003_cha",
        "@artifacts_2022-10-25-T19-22americold_tacoma_0004_cha",
        "@artifacts_2022-10-26_americold_modesto_0001_cha",
        "@artifacts_2022-10-26_americold_modesto_0002_cha",
        "@artifacts_2022-10-26_americold_modesto_0003_cha",
        "@artifacts_2022-10-26_americold_modesto_0005_cha",
        "@artifacts_2022-10-26_americold_modesto_0009_cha",
        "@artifacts_2022-10-26_americold_ontario_0003_cha",
        "@artifacts_2022-10-26_americold_ontario_0009_cha",
        "@artifacts_2022-10-26_americold_ontario_0011_cha",
        "@artifacts_2022-10-26_americold_ontario_0012_cha",
        "@artifacts_2022-10-28_americold_sanford_0001_cha",
        "@artifacts_2022-10-28_americold_sanford_0005_cha",
        "@artifacts_2022-10-28_americold_savannah_pooler_0006_cha",
        "@artifacts_2022-10-28_americold_taunton_0006_cha",
        "@artifacts_2022-10-28_americold_taunton_0007_cha",
        "@artifacts_2022-10-28_americold_taunton_0010_cha",
        "@artifacts_2022-10-28_feb_distributing_biloxi_0005_cha",
        "@artifacts_2022-10-28_hensley_chandler_0005_cha",
        "@artifacts_2022-10-28_hensley_phoenix_0003_cha",
        "@artifacts_2022-10-28_trieagle_ocala_0001_cha",
        "@artifacts_2022-10-28_trieagle_ocala_0005_cha",
        "@artifacts_2022-10-28_uscold_quakertown_0002_cha",
        "@artifacts_2022-10-31_americold_ontario_0001_cha",
        "@artifacts_2022-11-08_americold_savannah_bloomingdale_0006_cha",
        "@artifacts_2022-11-08_builderfirstsource_solanabeach_0003_cha",
        "@artifacts_2022-11-08_hensley_phoenix_0002_cha",
        "@artifacts_628cf2c8-4677-47e6-9af4-4bc1b098a304",
        "@artifacts_door-classifier-bloomingdale-0001-05-02",
        "@artifacts_door_classifier_resnet50_2021-12-27",
        "@artifacts_door_classifier_resnet50_20211129",
        "@artifacts_door_classifier_resnet50_dataset4",
        "@artifacts_doors_0630",
    ],
    visibility = ["//visibility:public"],
    deps = [
        requirement("torch"),
        requirement("scikit-learn"),
        requirement("torchvision"),
        requirement("opencv-python"),
        requirement("numpy"),
        "//core/incidents:utils",
        "//core/perception/inference/lib",
        "//core/structs",
        "//core/utils:yaml_jinja",
        "//lib/ml/inference/tasks/door_state/vanilla_resnet:factory",
        "//protos/perception/graph_config/v1:graphconfigpb_py_library",
    ],
)
