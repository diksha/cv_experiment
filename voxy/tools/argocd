#!/bin/bash

set -euo pipefail

FILEPATH=$(readlink -f "$0")
BASEDIR=$(dirname "$FILEPATH")
WORKSPACEDIR=$(dirname "$BASEDIR")
cd "$WORKSPACEDIR" || exit 1

BINARY="$WORKSPACEDIR/bazel-bin/third_party/argocd/argocd"

if ! test -f "$BINARY"; then
	"$WORKSPACEDIR"/bazel build //third_party/argocd:argocd
fi

exec "$BINARY" "$@"
